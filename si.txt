package launchTest;

import library.reporting.Evidence;
import library.reporting.Reporter;
import dav.library.reporting.EvidencePdfFile;
import library.settings.SettingsRun;

/**
 * Launcher ligero que orquesta y delega al PymeFlowController.
 * Mantiene la API pública original y delega la implementación concreta.
 */
public class LaunchTestPyme extends library.core.BaseTestNG_XBloque {

    private PymeFlowController flowController;

    @Override
    public void launchData() {
        // idéntico al original
        Reporter.initializeEvidenceType(new EvidencePdfFile());
        SettingsRun.DEFAULT_HEADER = 4;
    }

    @Override
    public void initializeControllerAndConfiguration() throws Exception {
        // delega toda la inicialización pesada al controller
        flowController = new PymeFlowController();
        flowController.initializeControllerAndConfiguration();
    }

    @Override
    public void doingTest() throws Exception {
        // delega el doingTest completo al controller
        flowController.doingTest();
    }

    @Override
    public void launchClose() {
        // delega el cierre/release al controller (manteniendo exactitud funcional)
        try {
            if (flowController != null) {
                flowController.launchClose();
            }
        } catch (Exception e) {
            Reporter.reportEvent(Reporter.MIC_FAIL, "Error en launchClose: " + e.getMessage());
        }
    }

    // --- Mantengo la API pública original: métodos que pueden ser llamados desde fuera ---
    // Estos simplemente delegan para garantizar compatibilidad binaria y comportamiento inalterado.

    public void Front() throws Exception {
        flowController.Front();
    }

    public void Frontfirmas(int firmas) throws Exception {
        flowController.Frontfirmas(firmas);
    }

    public void transar() throws Exception {
        flowController.transar();
    }

    public void aprobarConFirmasRestantes(int numFirmas, boolean desdeDetalle) throws Exception {
        flowController.aprobarConFirmasRestantes(numFirmas, desdeDetalle);
    }

    public void postAprobacionUnaFirma() throws Exception {
        flowController.postAprobacionUnaFirma();
    }

    public void flujoDivisasDocumentosYFormularios(boolean primeroGuardar) throws Exception {
        flowController.flujoDivisasDocumentosYFormularios(primeroGuardar);
    }

    public void adicionarRegistroMR(String tx) throws Exception {
        flowController.adicionarRegistroMR(tx);
    }

    public Object LoginStratus() throws Exception {
        return flowController.LoginStratus();
    }

    public Object logueoC360() throws Exception {
        return flowController.logueoC360();
    }

    public boolean ThereareOpenWindows() {
        return flowController.ThereareOpenWindows();
    }

    public Boolean WaitForNumberOfWindos() {
        return flowController.WaitForNumberOfWindos();
    }
}
